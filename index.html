<!DOCTYPE html>
<meta charset="utf-8" />
<html>
    <head>
        <meta charset="UTF-8">
        <title>돌깎시</title>
        <style> 
            #btn_blue{
                color: aliceblue;
                border-radius: 0.3em;
                margin-right:-4px;
                font-size:1em; 
                padding:4px 4px;
                background-color: rgb(95, 140, 223);
            }
            #btn_blue:hover{
                background-color: rgb(34, 66, 126);
            }
            #btn_red{
                color: aliceblue;
                border-radius: 0.3em;
                margin-right:-4px;
                font-size:1em; 
                padding:4px 4px;
                background-color: rgb(219, 106, 111);
            }
            #btn_red:hover{
                background-color: rgb(168, 42, 48);
            }
        </style>
    </head>
    <body style = " font-size:4em;
                    /* background-image : url('https://cdn.discordapp.com/attachments/829731525520130078/953707682555109456/unknown.png'); */
                    text-align: center;
                    background-repeat: no-repeat;
                    background-size: cover;">
        <span>
            돌 깎기 시뮬레이터 &nbsp;<span style="color: black"; id= chance>75</span>%
            <br><br>
            <span style="color:blue", id="one">◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇</span> &nbsp;
            <button id = "btn_blue", onclick="crack(1)">깎기</button><br><br>

            <span style="color:blue", id="two">◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇</span> &nbsp;
            <button id = "btn_blue", onclick="crack(2)">깎기</button><br><br>

            <span style="color:red", id="thr">◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇ ◇</span> &nbsp;
            <button id = "btn_red", onclick="crack(3)">깎기</button><br><br>

        </span>
        <script type="text/javascript">
            const per = document.getElementById("chance");
            const adder = -15;
            function crack(num){
                const rn = rnd();
                if(num==3) {
                    if(document.getElementById("thr").innerText[18] == "◆") {
                        return;
                    }
                    if(rn < Number(per.innerHTML)+adder ) {  //좋은건데 깨진거
                        per.innerHTML=Number(per.innerHTML)+10;
                        let i = 0;
                        while(true) {
                            if(document.getElementById("thr").innerHTML[i]=="◇") {
                                document.getElementById("thr").innerHTML = document.getElementById("thr").innerHTML.slice(0,i)+"<font color=\"lightgray\">◆</font>"+cutter(document.getElementById("thr").innerText);
                                break;
                            }
                            i+=1; if(document.getElementById("thr").innerHTML[i] == undefined) break;
                        }
                    }
                    else {          //실패
                        per.innerHTML=Number(per.innerHTML)-10;
                        let i = 0;
                        while(true) {
                            if(document.getElementById("thr").innerHTML[i]=="◇") {
                                document.getElementById("thr").innerHTML = document.getElementById("thr").innerHTML.slice(0,i)+"◆"+cutter(document.getElementById("thr").innerText);
                                break;
                            }
                            i+=1; if(document.getElementById("thr").innerHTML[i] == undefined) break;
                        }
                    }
                }   
                if(num==2) {
                    if(document.getElementById("two").innerText[18] == "◆") {
                        return;
                    }
                    if(rn < Number(per.innerHTML)+adder ) {  //성공 좋은거1
                        per.innerHTML=Number(per.innerHTML)-10;
                        let i = 0;
                        while(true) {
                            if(document.getElementById("two").innerHTML[i]=="◇") {
                                document.getElementById("two").innerHTML = document.getElementById("two").innerHTML.slice(0,i)+"◆"+cutter(document.getElementById("two").innerText);
                                break;
                            }
                            i+=1; if(document.getElementById("two").innerHTML[i] == undefined) break;
                        }
                    }
                    else {          //실패
                        per.innerHTML=Number(per.innerHTML)+10;
                        let i = 0;
                        while(true) {
                            if(document.getElementById("two").innerHTML[i]=="◇") {
                                document.getElementById("two").innerHTML = document.getElementById("two").innerHTML.slice(0,i)+"<font color=\"lightgray\">◆</font>"+cutter(document.getElementById("two").innerText); 
                                break;
                            }
                            i+=1; if(document.getElementById("two").innerHTML[i] == undefined) break;
                        }
                    }
                }
                if(num==1) {
                    if(document.getElementById("one").innerText[18] == "◆") {
                        return;
                    }
                    if(rn < Number(per.innerHTML)+adder ) {  //성공 좋은거
                        per.innerHTML=Number(per.innerHTML)-10;
                        let i = 0;
                        while(true) {
                            console.log(i);
                            if(document.getElementById("one").innerHTML[i]=="◇") {
                                document.getElementById("one").innerHTML = document.getElementById("one").innerHTML.slice(0,i)+"◆"+cutter(document.getElementById("one").innerText); 
                                break;
                            }
                            i+=1; if(document.getElementById("one").innerHTML[i] == undefined) break;
                        }
                    }
                    else {          //실패
                        per.innerHTML=Number(per.innerHTML)+10;
                        let i = 0;
                        while(true) {
                            console.log(i);
                            if(document.getElementById("one").innerHTML[i]=="◇") {
                                document.getElementById("one").innerHTML = document.getElementById("one").innerHTML.slice(0,i)+"<font color=\"lightgray\">◆</font>"+cutter(document.getElementById("one").innerText); 
                                break;
                            }
                            i+=1; if(document.getElementById("one").innerHTML[i] == undefined) break;
                        }
                    }
                }
                //범위 안넘어가게
                if(per.innerHTML>80) {
                    per.innerHTML = 75;
                }
                if(per.innerHTML<20) {
                    per.innerHTML = 25;
                }
            }
            function rnd() {
                return Math.floor(Math.random() * 100);
            }
            function cutter(sen) {
                for(let i = 0; i < sen.length; i++) {
                    if(sen[i] == "◇") {
                        return(' '+sen.slice(i+2,));
                    }
                }
            }
        </script>
    </body>
</html>
